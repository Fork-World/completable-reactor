<!DOCTYPE html>
<html>
<head>
    <title>Welcome to Kendo UI</title>
    <meta charset='utf-8' />
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" />
    <link rel="stylesheet" href="http://kendo.cdn.telerik.com/2016.3.914/styles/kendo.common.min.css" />
    <link rel="stylesheet" href="http://kendo.cdn.telerik.com/2016.3.914/styles/kendo.blueopal.min.css" />
    <style>html, body {
    height: 100%;
    padding: 0;
    margin: 0;
}

.nav {
    height: 40px;
    z-index: 10;
    position: relative;
    background-color: white !important;
}

.tab-content {
    margin-top: -40px;
    height: calc(100% - 40px);
}

.tab-pane, .diagram {
    height: 100%;
}

.diagram::before {
    content: 'Ctrl+Click-and-hold for dragging. Double click on transiton for pulling. Double click on transiton for pulling.';
    display: block;
    position: absolute;
    top: 40px;
    left: 0;
    background-color: #eee;
}

.docs {
    position: absolute;
    top: 40px;
    right: 0;
    width: 300px;
    height: auto;
    padding: 15px;
    background-color: #eee;
    overflow: scroll;
    max-height: 500px;
}

.k-animation-container .k-toolbar {
    display: none !important;
}</style>
    <script src="http://kendo.cdn.telerik.com/2016.3.914/js/jquery.min.js"></script>
    <script src="http://kendo.cdn.telerik.com/2016.3.914/js/kendo.all.min.js"></script>
    <script src='https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js'></script>
    <script>var _data = [ {
  "payload" : {
    "payloadName" : "SmsRoutingPayload",
    "payloadClass" : "ru.fix.cpapsm.subscription.kafka.processing.chain.payload.sms.SmsRoutingPayload",
    "payloadDoc" : [ "Маршрутизация SMS сообщения, полученного от абонента", "(MO траффик)" ]
  },
  "processors" : {
    "MessageBodyAnalyzeProcessor@0" : {
      "processorType" : "PLAIN",
      "coordinates" : {
        "x" : -30,
        "y" : 890
      },
      "coordinatesSource" : {
        "className" : "ru.fix.cpapsm.subscription.kafka.processing.config.SmppRoutingConfig",
        "fileName" : "SmppRoutingConfig.java",
        "fileNameLine" : 416
      },
      "processorDoc" : [ "Анализирует тело SMPP сообщения, принимая решение о дальнейшей маршрутизации" ],
      "requestDoc" : null,
      "handlerName" : "getSmsStopMessage",
      "handleBySource" : {
        "className" : "ru.fix.cpapsm.subscription.kafka.processing.config.SmppRoutingConfig",
        "fileName" : "SmppRoutingConfig.java",
        "fileNameLine" : 904
      }
    },
    "MessageBodyAnalyzeProcessor@1" : {
      "processorType" : "PLAIN",
      "coordinates" : {
        "x" : 1030,
        "y" : 780
      },
      "coordinatesSource" : {
        "className" : "ru.fix.cpapsm.subscription.kafka.processing.config.SmppRoutingConfig",
        "fileName" : "SmppRoutingConfig.java",
        "fileNameLine" : 417
      },
      "processorDoc" : [ "Анализирует тело SMPP сообщения, принимая решение о дальнейшей маршрутизации" ],
      "requestDoc" : null,
      "handlerName" : "getSmsStopMessage",
      "handleBySource" : {
        "className" : "ru.fix.cpapsm.subscription.kafka.processing.config.SmppRoutingConfig",
        "fileName" : "SmppRoutingConfig.java",
        "fileNameLine" : 122
      }
    },
    "RestrictSmsFetchProcessor@0" : {
      "processorType" : "PLAIN",
      "coordinates" : {
        "x" : 190,
        "y" : 320
      },
      "coordinatesSource" : {
        "className" : "ru.fix.cpapsm.subscription.kafka.processing.config.SmppRoutingConfig",
        "fileName" : "SmppRoutingConfig.java",
        "fileNameLine" : 418
      },
      "processorDoc" : [ "Получает данные по смс-запрету из postgresql, таблица cpapsm.restrict_sms." ],
      "requestDoc" : [ "Получает информацию о смс-запрете по тексту сообщения.", "Делает запрос в таблицу cpapsm.restrict_sms с условием sms_text = [текст пришедшего собщения]", "Вернет пустой результат, если тексту сообщения не соответствует ни один запрет." ],
      "handlerName" : "getSmsRestrictionMessage",
      "handleBySource" : {
        "className" : "ru.fix.cpapsm.subscription.kafka.processing.config.SmppRoutingConfig",
        "fileName" : "SmppRoutingConfig.java",
        "fileNameLine" : 222
      }
    },
    "ServiceFetchProcessor@0" : {
      "processorType" : "PLAIN",
      "coordinates" : {
        "x" : 320,
        "y" : 1140
      },
      "coordinatesSource" : {
        "className" : "ru.fix.cpapsm.subscription.kafka.processing.config.SmppRoutingConfig",
        "fileName" : "SmppRoutingConfig.java",
        "fileNameLine" : 426
      },
      "processorDoc" : [ "Получает данные по услуге из базы данных postgresql" ],
      "requestDoc" : [ "Получение услуг по короткому коду.", "Может вернуть пустой результат, если такой услуги нет в базе данных" ],
      "handlerName" : "fetchSubscriptionByShortCode",
      "handleBySource" : {
        "className" : "ru.fix.cpapsm.subscription.kafka.processing.config.SmppRoutingConfig",
        "fileName" : "SmppRoutingConfig.java",
        "fileNameLine" : 509
      }
    },
    "ServiceFetchProcessor@1" : {
      "processorType" : "PLAIN",
      "coordinates" : {
        "x" : 1180,
        "y" : 950
      },
      "coordinatesSource" : {
        "className" : "ru.fix.cpapsm.subscription.kafka.processing.config.SmppRoutingConfig",
        "fileName" : "SmppRoutingConfig.java",
        "fileNameLine" : 427
      },
      "processorDoc" : [ "Получает данные по услуге из базы данных postgresql" ],
      "requestDoc" : [ "Получение услуг по короткому коду.", "Может вернуть пустой результат, если такой услуги нет в базе данных" ],
      "handlerName" : "fetchSubscriptionByShortCode",
      "handleBySource" : {
        "className" : "ru.fix.cpapsm.subscription.kafka.processing.config.SmppRoutingConfig",
        "fileName" : "SmppRoutingConfig.java",
        "fileNameLine" : 509
      }
    },
    "ServiceFetchProcessor@2" : {
      "processorType" : "PLAIN",
      "coordinates" : {
        "x" : -80,
        "y" : 1270
      },
      "coordinatesSource" : {
        "className" : "ru.fix.cpapsm.subscription.kafka.processing.config.SmppRoutingConfig",
        "fileName" : "SmppRoutingConfig.java",
        "fileNameLine" : 428
      },
      "processorDoc" : [ "Получает данные по услуге из базы данных postgresql" ],
      "requestDoc" : [ "Получение услуг по короткому коду.", "Может вернуть пустой результат, если такой услуги нет в базе данных" ],
      "handlerName" : "fetchSubscriptionByShortCode",
      "handleBySource" : {
        "className" : "ru.fix.cpapsm.subscription.kafka.processing.config.SmppRoutingConfig",
        "fileName" : "SmppRoutingConfig.java",
        "fileNameLine" : 509
      }
    },
    "ServiceFetchProcessor@3" : {
      "processorType" : "PLAIN",
      "coordinates" : {
        "x" : 1510,
        "y" : 960
      },
      "coordinatesSource" : {
        "className" : "ru.fix.cpapsm.subscription.kafka.processing.config.SmppRoutingConfig",
        "fileName" : "SmppRoutingConfig.java",
        "fileNameLine" : 429
      },
      "processorDoc" : [ "Получает данные по услуге из базы данных postgresql" ],
      "requestDoc" : [ "Получение услуг по короткому коду.", "Может вернуть пустой результат, если такой услуги нет в базе данных" ],
      "handlerName" : "fetchSubscriptionByShortCode",
      "handleBySource" : {
        "className" : "ru.fix.cpapsm.subscription.kafka.processing.config.SmppRoutingConfig",
        "fileName" : "SmppRoutingConfig.java",
        "fileNameLine" : 509
      }
    },
    "ServiceFetchProcessor@4" : {
      "processorType" : "PLAIN",
      "coordinates" : {
        "x" : 800,
        "y" : 490
      },
      "coordinatesSource" : {
        "className" : "ru.fix.cpapsm.subscription.kafka.processing.config.SmppRoutingConfig",
        "fileName" : "SmppRoutingConfig.java",
        "fileNameLine" : 430
      },
      "processorDoc" : [ "Получает данные по услуге из базы данных postgresql" ],
      "requestDoc" : [ "Получение всех услуг-покупок заведенных на короткий номер.", "Может вернуть 0, 1 или несколько покупок.", "Считаем, что количество покупок по короткому номеру невелико." ],
      "handlerName" : "fetchPurchasesByShortNumber",
      "handleBySource" : {
        "className" : "ru.fix.cpapsm.subscription.kafka.processing.config.SmppRoutingConfig",
        "fileName" : "SmppRoutingConfig.java",
        "fileNameLine" : 271
      }
    },
    "ServiceFetchProcessor@5" : {
      "processorType" : "PLAIN",
      "coordinates" : {
        "x" : 1130,
        "y" : 300
      },
      "coordinatesSource" : {
        "className" : "ru.fix.cpapsm.subscription.kafka.processing.config.SmppRoutingConfig",
        "fileName" : "SmppRoutingConfig.java",
        "fileNameLine" : 431
      },
      "processorDoc" : [ "Получает данные по услуге из базы данных postgresql" ],
      "requestDoc" : [ "Получение услуги по умолчанию для данного типа трафика.", "Результат не должен быть пустым" ],
      "handlerName" : "fetchDefaultService",
      "handleBySource" : {
        "className" : "ru.fix.cpapsm.subscription.kafka.processing.config.SmppRoutingConfig",
        "fileName" : "SmppRoutingConfig.java",
        "fileNameLine" : 792
      }
    },
    "ShortNumberCheckProcessor@0" : {
      "processorType" : "PLAIN",
      "coordinates" : {
        "x" : 490,
        "y" : -150
      },
      "coordinatesSource" : {
        "className" : "ru.fix.cpapsm.subscription.kafka.processing.config.SmppRoutingConfig",
        "fileName" : "SmppRoutingConfig.java",
        "fileNameLine" : 432
      },
      "processorDoc" : [ "Необходим для проверки короткого номера входящих smpp сообщений", "и применения дальнейшей маршрутизации запроса" ],
      "requestDoc" : [ "Возвращает информацию по короткому номеру по данному каналу (USSD/SMS)" ],
      "handlerName" : "getShortNumber",
      "handleBySource" : {
        "className" : "ru.fix.cpapsm.subscription.kafka.processing.config.SmppRoutingConfig",
        "fileName" : "SmppRoutingConfig.java",
        "fileNameLine" : 204
      }
    },
    "SmppAocProcessor@0" : {
      "processorType" : "PLAIN",
      "coordinates" : {
        "x" : -490,
        "y" : 1250
      },
      "coordinatesSource" : {
        "className" : "ru.fix.cpapsm.subscription.kafka.processing.config.SmppRoutingConfig",
        "fileName" : "SmppRoutingConfig.java",
        "fileNameLine" : 433
      },
      "processorDoc" : [ "Проверка AoC-ов осуществляется путем сравнения информации, пришедшей", "в SMPP сообщении, с сохраненной информацией о действиях пользователя" ],
      "requestDoc" : null,
      "handlerName" : "checkAoc",
      "handleBySource" : {
        "className" : "ru.fix.cpapsm.subscription.kafka.processing.config.SmppRoutingConfig",
        "fileName" : "SmppRoutingConfig.java",
        "fileNameLine" : 139
      }
    },
    "SmppAocProcessor@1" : {
      "processorType" : "PLAIN",
      "coordinates" : {
        "x" : 740,
        "y" : 700
      },
      "coordinatesSource" : {
        "className" : "ru.fix.cpapsm.subscription.kafka.processing.config.SmppRoutingConfig",
        "fileName" : "SmppRoutingConfig.java",
        "fileNameLine" : 434
      },
      "processorDoc" : [ "Проверка AoC-ов осуществляется путем сравнения информации, пришедшей", "в SMPP сообщении, с сохраненной информацией о действиях пользователя" ],
      "requestDoc" : null,
      "handlerName" : "checkAoc",
      "handleBySource" : {
        "className" : "ru.fix.cpapsm.subscription.kafka.processing.config.SmppRoutingConfig",
        "fileName" : "SmppRoutingConfig.java",
        "fileNameLine" : 139
      }
    },
    "SmppMsisdnHistoryProcessor@0" : {
      "processorType" : "PLAIN",
      "coordinates" : {
        "x" : 780,
        "y" : -150
      },
      "coordinatesSource" : {
        "className" : "ru.fix.cpapsm.subscription.kafka.processing.config.SmppRoutingConfig",
        "fileName" : "SmppRoutingConfig.java",
        "fileNameLine" : 435
      },
      "processorDoc" : [ "Производит логирование параметров SMPP-сообщения в персистентное хранилище данных.", "Производится логирование всех SMPP-сообщений" ],
      "requestDoc" : [ "Производит логирование SMPP-трафика, записывая в таблицу HBase параметры запроса" ],
      "handlerName" : "logSmppRequest",
      "handleBySource" : {
        "className" : "ru.fix.cpapsm.subscription.kafka.processing.config.SmppRoutingConfig",
        "fileName" : "SmppRoutingConfig.java",
        "fileNameLine" : 809
      }
    },
    "SmppNotificationProcessor@0" : {
      "processorType" : "PLAIN",
      "coordinates" : {
        "x" : -560,
        "y" : 1650
      },
      "coordinatesSource" : {
        "className" : "ru.fix.cpapsm.subscription.kafka.processing.config.SmppRoutingConfig",
        "fileName" : "SmppRoutingConfig.java",
        "fileNameLine" : 436
      },
      "processorDoc" : [ "Производит нотификацию пользователя о событиях, возникших при роутинге SMPP трафика" ],
      "requestDoc" : [ "Отправляет СМС сообщение о некорректном ответе на AoC на указанный номер" ],
      "handlerName" : "notify",
      "handleBySource" : {
        "className" : "ru.fix.cpapsm.subscription.kafka.processing.config.SmppRoutingConfig",
        "fileName" : "SmppRoutingConfig.java",
        "fileNameLine" : 300
      }
    },
    "SmsRequestConstructProcessor@0" : {
      "processorType" : "PLAIN",
      "coordinates" : {
        "x" : -40,
        "y" : 520
      },
      "coordinatesSource" : {
        "className" : "ru.fix.cpapsm.subscription.kafka.processing.config.SmppRoutingConfig",
        "fileName" : "SmppRoutingConfig.java",
        "fileNameLine" : 419
      },
      "processorDoc" : [ "Конструирует терминальные запросы по предварительно заполненным промежуточным данным" ],
      "requestDoc" : [ "Создает запрос для отправки в основной processor chain" ],
      "handlerName" : "createRequest",
      "handleBySource" : {
        "className" : "ru.fix.cpapsm.subscription.kafka.processing.config.SmppRoutingConfig",
        "fileName" : "SmppRoutingConfig.java",
        "fileNameLine" : 184
      }
    },
    "SmsRequestConstructProcessor@1" : {
      "processorType" : "PLAIN",
      "coordinates" : {
        "x" : -70,
        "y" : 1640
      },
      "coordinatesSource" : {
        "className" : "ru.fix.cpapsm.subscription.kafka.processing.config.SmppRoutingConfig",
        "fileName" : "SmppRoutingConfig.java",
        "fileNameLine" : 420
      },
      "processorDoc" : [ "Конструирует терминальные запросы по предварительно заполненным промежуточным данным" ],
      "requestDoc" : [ "Создает запрос для отправки в основной processor chain" ],
      "handlerName" : "createRequest",
      "handleBySource" : {
        "className" : "ru.fix.cpapsm.subscription.kafka.processing.config.SmppRoutingConfig",
        "fileName" : "SmppRoutingConfig.java",
        "fileNameLine" : 184
      }
    },
    "SmsRequestConstructProcessor@2" : {
      "processorType" : "PLAIN",
      "coordinates" : {
        "x" : 590,
        "y" : 900
      },
      "coordinatesSource" : {
        "className" : "ru.fix.cpapsm.subscription.kafka.processing.config.SmppRoutingConfig",
        "fileName" : "SmppRoutingConfig.java",
        "fileNameLine" : 422
      },
      "processorDoc" : [ "Конструирует терминальные запросы по предварительно заполненным промежуточным данным" ],
      "requestDoc" : [ "Создает запрос для отправки в основной processor chain" ],
      "handlerName" : "createRequest",
      "handleBySource" : {
        "className" : "ru.fix.cpapsm.subscription.kafka.processing.config.SmppRoutingConfig",
        "fileName" : "SmppRoutingConfig.java",
        "fileNameLine" : 184
      }
    },
    "SmsRequestConstructProcessor@3" : {
      "processorType" : "PLAIN",
      "coordinates" : {
        "x" : 1640,
        "y" : 1160
      },
      "coordinatesSource" : {
        "className" : "ru.fix.cpapsm.subscription.kafka.processing.config.SmppRoutingConfig",
        "fileName" : "SmppRoutingConfig.java",
        "fileNameLine" : 423
      },
      "processorDoc" : [ "Конструирует терминальные запросы по предварительно заполненным промежуточным данным" ],
      "requestDoc" : [ "Создает запрос для отправки в основной processor chain" ],
      "handlerName" : "createRequest",
      "handleBySource" : {
        "className" : "ru.fix.cpapsm.subscription.kafka.processing.config.SmppRoutingConfig",
        "fileName" : "SmppRoutingConfig.java",
        "fileNameLine" : 184
      }
    },
    "SmsRequestConstructProcessor@4" : {
      "processorType" : "PLAIN",
      "coordinates" : {
        "x" : 910,
        "y" : 900
      },
      "coordinatesSource" : {
        "className" : "ru.fix.cpapsm.subscription.kafka.processing.config.SmppRoutingConfig",
        "fileName" : "SmppRoutingConfig.java",
        "fileNameLine" : 424
      },
      "processorDoc" : [ "Конструирует терминальные запросы по предварительно заполненным промежуточным данным" ],
      "requestDoc" : [ "Создает запрос для отправки в основной processor chain" ],
      "handlerName" : "createRequest",
      "handleBySource" : {
        "className" : "ru.fix.cpapsm.subscription.kafka.processing.config.SmppRoutingConfig",
        "fileName" : "SmppRoutingConfig.java",
        "fileNameLine" : 184
      }
    },
    "SmsRequestConstructProcessor@5" : {
      "processorType" : "PLAIN",
      "coordinates" : {
        "x" : 1070,
        "y" : 1170
      },
      "coordinatesSource" : {
        "className" : "ru.fix.cpapsm.subscription.kafka.processing.config.SmppRoutingConfig",
        "fileName" : "SmppRoutingConfig.java",
        "fileNameLine" : 425
      },
      "processorDoc" : [ "Конструирует терминальные запросы по предварительно заполненным промежуточным данным" ],
      "requestDoc" : [ "Создает запрос для отправки в основной processor chain" ],
      "handlerName" : "createRequest",
      "handleBySource" : {
        "className" : "ru.fix.cpapsm.subscription.kafka.processing.config.SmppRoutingConfig",
        "fileName" : "SmppRoutingConfig.java",
        "fileNameLine" : 184
      }
    },
    "SmsRequestConstructProcessor@6" : {
      "processorType" : "PLAIN",
      "coordinates" : {
        "x" : 1140,
        "y" : 490
      },
      "coordinatesSource" : {
        "className" : "ru.fix.cpapsm.subscription.kafka.processing.config.SmppRoutingConfig",
        "fileName" : "SmppRoutingConfig.java",
        "fileNameLine" : 421
      },
      "processorDoc" : [ "Конструирует терминальные запросы по предварительно заполненным промежуточным данным" ],
      "requestDoc" : [ "Создает запрос для отправки в основной processor chain" ],
      "handlerName" : "createRequest",
      "handleBySource" : {
        "className" : "ru.fix.cpapsm.subscription.kafka.processing.config.SmppRoutingConfig",
        "fileName" : "SmppRoutingConfig.java",
        "fileNameLine" : 184
      }
    },
    "UserInfoPayload@0" : {
      "processorType" : "SUBGRAPH",
      "coordinates" : {
        "x" : 330,
        "y" : 570
      },
      "coordinatesSource" : {
        "className" : "ru.fix.cpapsm.subscription.kafka.processing.config.SmppRoutingConfig",
        "fileName" : "SmppRoutingConfig.java",
        "fileNameLine" : 437
      },
      "processorDoc" : [ "Получение информации по msisdn.", "Данные получаются из xMNP-ml, HBase и PostgreSQL.", "Если никаких сведений не найдено, то вернется пустой результат." ],
      "requestDoc" : null,
      "handlerName" : null,
      "handleBySource" : null
    },
    "UserInfoPayload@1" : {
      "processorType" : "SUBGRAPH",
      "coordinates" : {
        "x" : 630,
        "y" : 260
      },
      "coordinatesSource" : {
        "className" : "ru.fix.cpapsm.subscription.kafka.processing.config.SmppRoutingConfig",
        "fileName" : "SmppRoutingConfig.java",
        "fileNameLine" : 438
      },
      "processorDoc" : [ "Получение информации по msisdn.", "Данные получаются из xMNP-ml, HBase и PostgreSQL.", "Если никаких сведений не найдено, то вернется пустой результат." ],
      "requestDoc" : null,
      "handlerName" : null,
      "handleBySource" : null
    }
  },
  "startPoint" : {
    "coordinates" : {
      "x" : 690,
      "y" : -240
    },
    "processors" : [ "ShortNumberCheckProcessor@0", "SmppMsisdnHistoryProcessor@0" ]
  },
  "mergeGroups" : [ {
    "mergePoints" : [ {
      "processor" : "SmppMsisdnHistoryProcessor@0",
      "coordinates" : {
        "x" : 850,
        "y" : -50
      },
      "coordinatesSource" : {
        "className" : "ru.fix.cpapsm.subscription.kafka.processing.config.SmppRoutingConfig",
        "fileName" : "SmppRoutingConfig.java",
        "fileNameLine" : 439
      },
      "mergeSource" : {
        "className" : "ru.fix.cpapsm.subscription.kafka.processing.config.SmppRoutingConfig",
        "fileName" : "SmppRoutingConfig.java",
        "fileNameLine" : 810
      },
      "transitions" : [ {
        "mergeStatuses" : [ ],
        "isOnAny" : true,
        "isComplete" : false,
        "mergeProcessor" : "ShortNumberCheckProcessor@0",
        "handleByProcessor" : null,
        "completeCoordinates" : {
          "x" : 100,
          "y" : 100
        },
        "completeCoordinatesSource" : null,
        "transitionsDoc" : [ ]
      } ]
    }, {
      "processor" : "ShortNumberCheckProcessor@0",
      "coordinates" : {
        "x" : 590,
        "y" : -10
      },
      "coordinatesSource" : {
        "className" : "ru.fix.cpapsm.subscription.kafka.processing.config.SmppRoutingConfig",
        "fileName" : "SmppRoutingConfig.java",
        "fileNameLine" : 440
      },
      "mergeSource" : {
        "className" : "ru.fix.cpapsm.subscription.kafka.processing.config.SmppRoutingConfig",
        "fileName" : "SmppRoutingConfig.java",
        "fileNameLine" : 205
      },
      "transitions" : [ {
        "mergeStatuses" : [ "DEFAULT_SMS_PURCHASE" ],
        "isOnAny" : false,
        "isComplete" : false,
        "mergeProcessor" : null,
        "handleByProcessor" : "ServiceFetchProcessor@5",
        "completeCoordinates" : {
          "x" : 100,
          "y" : 100
        },
        "completeCoordinatesSource" : null,
        "transitionsDoc" : [ {
          "mergeStatus" : "DEFAULT_SMS_PURCHASE",
          "docs" : [ "Запрос пришёл на незарегистрированный КН по SMS" ]
        } ]
      }, {
        "mergeStatuses" : [ "PLATFORM_SHORT_NUMBER" ],
        "isOnAny" : false,
        "isComplete" : false,
        "mergeProcessor" : null,
        "handleByProcessor" : "RestrictSmsFetchProcessor@0",
        "completeCoordinates" : {
          "x" : 100,
          "y" : 100
        },
        "completeCoordinatesSource" : null,
        "transitionsDoc" : [ {
          "mergeStatus" : "PLATFORM_SHORT_NUMBER",
          "docs" : [ "Запрос пришёл на служебный КН" ]
        } ]
      }, {
        "mergeStatuses" : [ "OTHER_SERVICE_SHORT_NUMBER" ],
        "isOnAny" : false,
        "isComplete" : false,
        "mergeProcessor" : null,
        "handleByProcessor" : "UserInfoPayload@1",
        "completeCoordinates" : {
          "x" : 100,
          "y" : 100
        },
        "completeCoordinatesSource" : null,
        "transitionsDoc" : [ {
          "mergeStatus" : "OTHER_SERVICE_SHORT_NUMBER",
          "docs" : [ "Запрос пришёл на зарегистрированный КН" ]
        } ]
      } ]
    } ]
  }, {
    "mergePoints" : [ {
      "processor" : "ServiceFetchProcessor@5",
      "coordinates" : {
        "x" : 1210,
        "y" : 400
      },
      "coordinatesSource" : {
        "className" : "ru.fix.cpapsm.subscription.kafka.processing.config.SmppRoutingConfig",
        "fileName" : "SmppRoutingConfig.java",
        "fileNameLine" : 441
      },
      "mergeSource" : {
        "className" : "ru.fix.cpapsm.subscription.kafka.processing.config.SmppRoutingConfig",
        "fileName" : "SmppRoutingConfig.java",
        "fileNameLine" : 793
      },
      "transitions" : [ {
        "mergeStatuses" : [ ],
        "isOnAny" : true,
        "isComplete" : false,
        "mergeProcessor" : null,
        "handleByProcessor" : "SmsRequestConstructProcessor@6",
        "completeCoordinates" : {
          "x" : 100,
          "y" : 100
        },
        "completeCoordinatesSource" : null,
        "transitionsDoc" : [ ]
      } ]
    } ]
  }, {
    "mergePoints" : [ {
      "processor" : "SmsRequestConstructProcessor@6",
      "coordinates" : {
        "x" : 1390,
        "y" : 500
      },
      "coordinatesSource" : {
        "className" : "ru.fix.cpapsm.subscription.kafka.processing.config.SmppRoutingConfig",
        "fileName" : "SmppRoutingConfig.java",
        "fileNameLine" : 442
      },
      "mergeSource" : {
        "className" : "ru.fix.cpapsm.subscription.kafka.processing.config.SmppRoutingConfig",
        "fileName" : "SmppRoutingConfig.java",
        "fileNameLine" : 185
      },
      "transitions" : [ {
        "mergeStatuses" : [ ],
        "isOnAny" : true,
        "isComplete" : true,
        "mergeProcessor" : null,
        "handleByProcessor" : null,
        "completeCoordinates" : {
          "x" : 1500,
          "y" : 510
        },
        "completeCoordinatesSource" : {
          "className" : "ru.fix.cpapsm.subscription.kafka.processing.config.SmppRoutingConfig",
          "fileName" : "SmppRoutingConfig.java",
          "fileNameLine" : 463
        },
        "transitionsDoc" : [ ]
      } ]
    } ]
  }, {
    "mergePoints" : [ {
      "processor" : "RestrictSmsFetchProcessor@0",
      "coordinates" : {
        "x" : 240,
        "y" : 420
      },
      "coordinatesSource" : {
        "className" : "ru.fix.cpapsm.subscription.kafka.processing.config.SmppRoutingConfig",
        "fileName" : "SmppRoutingConfig.java",
        "fileNameLine" : 443
      },
      "mergeSource" : {
        "className" : "ru.fix.cpapsm.subscription.kafka.processing.config.SmppRoutingConfig",
        "fileName" : "SmppRoutingConfig.java",
        "fileNameLine" : 223
      },
      "transitions" : [ {
        "mergeStatuses" : [ "RESTRICTION_MESSAGE" ],
        "isOnAny" : false,
        "isComplete" : false,
        "mergeProcessor" : null,
        "handleByProcessor" : "SmsRequestConstructProcessor@0",
        "completeCoordinates" : {
          "x" : 100,
          "y" : 100
        },
        "completeCoordinatesSource" : null,
        "transitionsDoc" : [ {
          "mergeStatus" : "RESTRICTION_MESSAGE",
          "docs" : [ "Текст сообщение равен запросу на установку запрета" ]
        } ]
      }, {
        "mergeStatuses" : [ "OTHER_MESSAGE" ],
        "isOnAny" : false,
        "isComplete" : false,
        "mergeProcessor" : null,
        "handleByProcessor" : "UserInfoPayload@0",
        "completeCoordinates" : {
          "x" : 100,
          "y" : 100
        },
        "completeCoordinatesSource" : null,
        "transitionsDoc" : [ {
          "mergeStatus" : "OTHER_MESSAGE",
          "docs" : [ "Иной текст сообщения" ]
        } ]
      } ]
    } ]
  }, {
    "mergePoints" : [ {
      "processor" : "SmsRequestConstructProcessor@0",
      "coordinates" : {
        "x" : -10,
        "y" : 630
      },
      "coordinatesSource" : {
        "className" : "ru.fix.cpapsm.subscription.kafka.processing.config.SmppRoutingConfig",
        "fileName" : "SmppRoutingConfig.java",
        "fileNameLine" : 444
      },
      "mergeSource" : {
        "className" : "ru.fix.cpapsm.subscription.kafka.processing.config.SmppRoutingConfig",
        "fileName" : "SmppRoutingConfig.java",
        "fileNameLine" : 185
      },
      "transitions" : [ {
        "mergeStatuses" : [ ],
        "isOnAny" : true,
        "isComplete" : true,
        "mergeProcessor" : null,
        "handleByProcessor" : null,
        "completeCoordinates" : {
          "x" : -120,
          "y" : 710
        },
        "completeCoordinatesSource" : {
          "className" : "ru.fix.cpapsm.subscription.kafka.processing.config.SmppRoutingConfig",
          "fileName" : "SmppRoutingConfig.java",
          "fileNameLine" : 464
        },
        "transitionsDoc" : [ ]
      } ]
    } ]
  }, {
    "mergePoints" : [ {
      "processor" : "MessageBodyAnalyzeProcessor@0",
      "coordinates" : {
        "x" : 0,
        "y" : 1010
      },
      "coordinatesSource" : {
        "className" : "ru.fix.cpapsm.subscription.kafka.processing.config.SmppRoutingConfig",
        "fileName" : "SmppRoutingConfig.java",
        "fileNameLine" : 445
      },
      "mergeSource" : {
        "className" : "ru.fix.cpapsm.subscription.kafka.processing.config.SmppRoutingConfig",
        "fileName" : "SmppRoutingConfig.java",
        "fileNameLine" : 905
      },
      "transitions" : [ {
        "mergeStatuses" : [ "UNSUBSCRIBE_MESSAGE" ],
        "isOnAny" : false,
        "isComplete" : false,
        "mergeProcessor" : null,
        "handleByProcessor" : "ServiceFetchProcessor@0",
        "completeCoordinates" : {
          "x" : 100,
          "y" : 100
        },
        "completeCoordinatesSource" : null,
        "transitionsDoc" : [ {
          "mergeStatus" : "UNSUBSCRIBE_MESSAGE",
          "docs" : [ "Текст сообщения содержит префикс отписки" ]
        } ]
      }, {
        "mergeStatuses" : [ "AOC_MESSAGE" ],
        "isOnAny" : false,
        "isComplete" : false,
        "mergeProcessor" : null,
        "handleByProcessor" : "SmppAocProcessor@0",
        "completeCoordinates" : {
          "x" : 100,
          "y" : 100
        },
        "completeCoordinatesSource" : null,
        "transitionsDoc" : [ {
          "mergeStatus" : "AOC_MESSAGE",
          "docs" : [ "Ответ на AoC" ]
        } ]
      }, {
        "mergeStatuses" : [ "OTHER_MESSAGE" ],
        "isOnAny" : false,
        "isComplete" : false,
        "mergeProcessor" : null,
        "handleByProcessor" : "ServiceFetchProcessor@2",
        "completeCoordinates" : {
          "x" : 100,
          "y" : 100
        },
        "completeCoordinatesSource" : null,
        "transitionsDoc" : [ {
          "mergeStatus" : "OTHER_MESSAGE",
          "docs" : [ "Иной текст сообщения" ]
        } ]
      } ]
    } ]
  }, {
    "mergePoints" : [ {
      "processor" : "ServiceFetchProcessor@2",
      "coordinates" : {
        "x" : -10,
        "y" : 1400
      },
      "coordinatesSource" : {
        "className" : "ru.fix.cpapsm.subscription.kafka.processing.config.SmppRoutingConfig",
        "fileName" : "SmppRoutingConfig.java",
        "fileNameLine" : 449
      },
      "mergeSource" : {
        "className" : "ru.fix.cpapsm.subscription.kafka.processing.config.SmppRoutingConfig",
        "fileName" : "SmppRoutingConfig.java",
        "fileNameLine" : 510
      },
      "transitions" : [ {
        "mergeStatuses" : [ "SINGLE_SERVICE" ],
        "isOnAny" : false,
        "isComplete" : false,
        "mergeProcessor" : null,
        "handleByProcessor" : "SmsRequestConstructProcessor@1",
        "completeCoordinates" : {
          "x" : 100,
          "y" : 100
        },
        "completeCoordinatesSource" : null,
        "transitionsDoc" : [ {
          "mergeStatus" : "SINGLE_SERVICE",
          "docs" : [ "Найден один сервис" ]
        } ]
      }, {
        "mergeStatuses" : [ "SERVICE_NOT_FOUND" ],
        "isOnAny" : false,
        "isComplete" : true,
        "mergeProcessor" : null,
        "handleByProcessor" : null,
        "completeCoordinates" : {
          "x" : -130,
          "y" : 1460
        },
        "completeCoordinatesSource" : {
          "className" : "ru.fix.cpapsm.subscription.kafka.processing.config.SmppRoutingConfig",
          "fileName" : "SmppRoutingConfig.java",
          "fileNameLine" : 467
        },
        "transitionsDoc" : [ {
          "mergeStatus" : "SERVICE_NOT_FOUND",
          "docs" : [ "Сервис не найден" ]
        } ]
      } ]
    } ]
  }, {
    "mergePoints" : [ {
      "processor" : "SmppAocProcessor@0",
      "coordinates" : {
        "x" : -340,
        "y" : 1560
      },
      "coordinatesSource" : {
        "className" : "ru.fix.cpapsm.subscription.kafka.processing.config.SmppRoutingConfig",
        "fileName" : "SmppRoutingConfig.java",
        "fileNameLine" : 446
      },
      "mergeSource" : {
        "className" : "ru.fix.cpapsm.subscription.kafka.processing.config.SmppRoutingConfig",
        "fileName" : "SmppRoutingConfig.java",
        "fileNameLine" : 140
      },
      "transitions" : [ {
        "mergeStatuses" : [ "SMS_SUBSCRIPTION_AOC", "PAY_BY_CLICK_AOC" ],
        "isOnAny" : false,
        "isComplete" : false,
        "mergeProcessor" : null,
        "handleByProcessor" : "SmsRequestConstructProcessor@1",
        "completeCoordinates" : {
          "x" : 100,
          "y" : 100
        },
        "completeCoordinatesSource" : null,
        "transitionsDoc" : [ {
          "mergeStatus" : "SMS_SUBSCRIPTION_AOC",
          "docs" : [ "Корректный AoC. Продолжение SMS-подписки." ]
        }, {
          "mergeStatus" : "PAY_BY_CLICK_AOC",
          "docs" : [ "Корректный AoC. Продолжение PbC. (web-покупки)" ]
        } ]
      }, {
        "mergeStatuses" : [ "INCORRECT_AOC" ],
        "isOnAny" : false,
        "isComplete" : false,
        "mergeProcessor" : null,
        "handleByProcessor" : "SmppNotificationProcessor@0",
        "completeCoordinates" : {
          "x" : 100,
          "y" : 100
        },
        "completeCoordinatesSource" : null,
        "transitionsDoc" : [ {
          "mergeStatus" : "INCORRECT_AOC",
          "docs" : [ "Некорректный AoC. У абонента есть активный аок, но присланный аок не совпадает с активным" ]
        } ]
      } ]
    } ]
  }, {
    "mergePoints" : [ {
      "processor" : "SmppNotificationProcessor@0",
      "coordinates" : {
        "x" : -490,
        "y" : 1760
      },
      "coordinatesSource" : {
        "className" : "ru.fix.cpapsm.subscription.kafka.processing.config.SmppRoutingConfig",
        "fileName" : "SmppRoutingConfig.java",
        "fileNameLine" : 448
      },
      "mergeSource" : {
        "className" : "ru.fix.cpapsm.subscription.kafka.processing.config.SmppRoutingConfig",
        "fileName" : "SmppRoutingConfig.java",
        "fileNameLine" : 301
      },
      "transitions" : [ {
        "mergeStatuses" : [ ],
        "isOnAny" : true,
        "isComplete" : true,
        "mergeProcessor" : null,
        "handleByProcessor" : null,
        "completeCoordinates" : {
          "x" : -540,
          "y" : 1850
        },
        "completeCoordinatesSource" : {
          "className" : "ru.fix.cpapsm.subscription.kafka.processing.config.SmppRoutingConfig",
          "fileName" : "SmppRoutingConfig.java",
          "fileNameLine" : 466
        },
        "transitionsDoc" : [ ]
      } ]
    } ]
  }, {
    "mergePoints" : [ {
      "processor" : "UserInfoPayload@0",
      "coordinates" : {
        "x" : 260,
        "y" : 730
      },
      "coordinatesSource" : {
        "className" : "ru.fix.cpapsm.subscription.kafka.processing.config.SmppRoutingConfig",
        "fileName" : "SmppRoutingConfig.java",
        "fileNameLine" : 460
      },
      "mergeSource" : null,
      "transitions" : [ {
        "mergeStatuses" : [ "OK" ],
        "isOnAny" : false,
        "isComplete" : false,
        "mergeProcessor" : null,
        "handleByProcessor" : "MessageBodyAnalyzeProcessor@0",
        "completeCoordinates" : {
          "x" : 100,
          "y" : 100
        },
        "completeCoordinatesSource" : null,
        "transitionsDoc" : [ {
          "mergeStatus" : "OK",
          "docs" : null
        } ]
      }, {
        "mergeStatuses" : [ "CANCEL" ],
        "isOnAny" : false,
        "isComplete" : true,
        "mergeProcessor" : null,
        "handleByProcessor" : null,
        "completeCoordinates" : {
          "x" : 380,
          "y" : 840
        },
        "completeCoordinatesSource" : {
          "className" : "ru.fix.cpapsm.subscription.kafka.processing.config.SmppRoutingConfig",
          "fileName" : "SmppRoutingConfig.java",
          "fileNameLine" : 476
        },
        "transitionsDoc" : [ {
          "mergeStatus" : "CANCEL",
          "docs" : null
        } ]
      } ]
    } ]
  }, {
    "mergePoints" : [ {
      "processor" : "ServiceFetchProcessor@0",
      "coordinates" : {
        "x" : 300,
        "y" : 1270
      },
      "coordinatesSource" : {
        "className" : "ru.fix.cpapsm.subscription.kafka.processing.config.SmppRoutingConfig",
        "fileName" : "SmppRoutingConfig.java",
        "fileNameLine" : 450
      },
      "mergeSource" : {
        "className" : "ru.fix.cpapsm.subscription.kafka.processing.config.SmppRoutingConfig",
        "fileName" : "SmppRoutingConfig.java",
        "fileNameLine" : 510
      },
      "transitions" : [ {
        "mergeStatuses" : [ "SINGLE_SERVICE" ],
        "isOnAny" : false,
        "isComplete" : false,
        "mergeProcessor" : null,
        "handleByProcessor" : "SmsRequestConstructProcessor@1",
        "completeCoordinates" : {
          "x" : 100,
          "y" : 100
        },
        "completeCoordinatesSource" : null,
        "transitionsDoc" : [ {
          "mergeStatus" : "SINGLE_SERVICE",
          "docs" : [ "Найден один сервис" ]
        } ]
      }, {
        "mergeStatuses" : [ "SERVICE_NOT_FOUND" ],
        "isOnAny" : false,
        "isComplete" : true,
        "mergeProcessor" : null,
        "handleByProcessor" : null,
        "completeCoordinates" : {
          "x" : 480,
          "y" : 1360
        },
        "completeCoordinatesSource" : {
          "className" : "ru.fix.cpapsm.subscription.kafka.processing.config.SmppRoutingConfig",
          "fileName" : "SmppRoutingConfig.java",
          "fileNameLine" : 468
        },
        "transitionsDoc" : [ {
          "mergeStatus" : "SERVICE_NOT_FOUND",
          "docs" : [ "Сервис не найден" ]
        } ]
      } ]
    } ]
  }, {
    "mergePoints" : [ {
      "processor" : "SmsRequestConstructProcessor@1",
      "coordinates" : {
        "x" : 10,
        "y" : 1760
      },
      "coordinatesSource" : {
        "className" : "ru.fix.cpapsm.subscription.kafka.processing.config.SmppRoutingConfig",
        "fileName" : "SmppRoutingConfig.java",
        "fileNameLine" : 447
      },
      "mergeSource" : {
        "className" : "ru.fix.cpapsm.subscription.kafka.processing.config.SmppRoutingConfig",
        "fileName" : "SmppRoutingConfig.java",
        "fileNameLine" : 185
      },
      "transitions" : [ {
        "mergeStatuses" : [ ],
        "isOnAny" : true,
        "isComplete" : true,
        "mergeProcessor" : null,
        "handleByProcessor" : null,
        "completeCoordinates" : {
          "x" : -10,
          "y" : 1860
        },
        "completeCoordinatesSource" : {
          "className" : "ru.fix.cpapsm.subscription.kafka.processing.config.SmppRoutingConfig",
          "fileName" : "SmppRoutingConfig.java",
          "fileNameLine" : 465
        },
        "transitionsDoc" : [ ]
      } ]
    } ]
  }, {
    "mergePoints" : [ {
      "processor" : "UserInfoPayload@1",
      "coordinates" : {
        "x" : 710,
        "y" : 390
      },
      "coordinatesSource" : {
        "className" : "ru.fix.cpapsm.subscription.kafka.processing.config.SmppRoutingConfig",
        "fileName" : "SmppRoutingConfig.java",
        "fileNameLine" : 461
      },
      "mergeSource" : null,
      "transitions" : [ {
        "mergeStatuses" : [ "OK" ],
        "isOnAny" : false,
        "isComplete" : false,
        "mergeProcessor" : null,
        "handleByProcessor" : "ServiceFetchProcessor@4",
        "completeCoordinates" : {
          "x" : 100,
          "y" : 100
        },
        "completeCoordinatesSource" : null,
        "transitionsDoc" : [ {
          "mergeStatus" : "OK",
          "docs" : null
        } ]
      }, {
        "mergeStatuses" : [ "CANCEL" ],
        "isOnAny" : false,
        "isComplete" : true,
        "mergeProcessor" : null,
        "handleByProcessor" : null,
        "completeCoordinates" : {
          "x" : 540,
          "y" : 430
        },
        "completeCoordinatesSource" : {
          "className" : "ru.fix.cpapsm.subscription.kafka.processing.config.SmppRoutingConfig",
          "fileName" : "SmppRoutingConfig.java",
          "fileNameLine" : 477
        },
        "transitionsDoc" : [ {
          "mergeStatus" : "CANCEL",
          "docs" : null
        } ]
      } ]
    } ]
  }, {
    "mergePoints" : [ {
      "processor" : "ServiceFetchProcessor@4",
      "coordinates" : {
        "x" : 820,
        "y" : 600
      },
      "coordinatesSource" : {
        "className" : "ru.fix.cpapsm.subscription.kafka.processing.config.SmppRoutingConfig",
        "fileName" : "SmppRoutingConfig.java",
        "fileNameLine" : 451
      },
      "mergeSource" : {
        "className" : "ru.fix.cpapsm.subscription.kafka.processing.config.SmppRoutingConfig",
        "fileName" : "SmppRoutingConfig.java",
        "fileNameLine" : 272
      },
      "transitions" : [ {
        "mergeStatuses" : [ "SINGLE_SERVICE" ],
        "isOnAny" : false,
        "isComplete" : false,
        "mergeProcessor" : null,
        "handleByProcessor" : "SmppAocProcessor@1",
        "completeCoordinates" : {
          "x" : 100,
          "y" : 100
        },
        "completeCoordinatesSource" : null,
        "transitionsDoc" : [ {
          "mergeStatus" : "SINGLE_SERVICE",
          "docs" : [ "Найден один сервис" ]
        } ]
      }, {
        "mergeStatuses" : [ "MORE_THAN_ONE_SERVICE" ],
        "isOnAny" : false,
        "isComplete" : true,
        "mergeProcessor" : null,
        "handleByProcessor" : null,
        "completeCoordinates" : {
          "x" : 1200,
          "y" : 660
        },
        "completeCoordinatesSource" : {
          "className" : "ru.fix.cpapsm.subscription.kafka.processing.config.SmppRoutingConfig",
          "fileName" : "SmppRoutingConfig.java",
          "fileNameLine" : 469
        },
        "transitionsDoc" : [ {
          "mergeStatus" : "MORE_THAN_ONE_SERVICE",
          "docs" : [ "Найдено больше одно сервиса" ]
        } ]
      }, {
        "mergeStatuses" : [ "SERVICE_NOT_FOUND" ],
        "isOnAny" : false,
        "isComplete" : false,
        "mergeProcessor" : null,
        "handleByProcessor" : "MessageBodyAnalyzeProcessor@1",
        "completeCoordinates" : {
          "x" : 100,
          "y" : 100
        },
        "completeCoordinatesSource" : null,
        "transitionsDoc" : [ {
          "mergeStatus" : "SERVICE_NOT_FOUND",
          "docs" : [ "Сервис не найден" ]
        } ]
      } ]
    } ]
  }, {
    "mergePoints" : [ {
      "processor" : "SmppAocProcessor@1",
      "coordinates" : {
        "x" : 820,
        "y" : 810
      },
      "coordinatesSource" : {
        "className" : "ru.fix.cpapsm.subscription.kafka.processing.config.SmppRoutingConfig",
        "fileName" : "SmppRoutingConfig.java",
        "fileNameLine" : 452
      },
      "mergeSource" : {
        "className" : "ru.fix.cpapsm.subscription.kafka.processing.config.SmppRoutingConfig",
        "fileName" : "SmppRoutingConfig.java",
        "fileNameLine" : 140
      },
      "transitions" : [ {
        "mergeStatuses" : [ "NO_AOC" ],
        "isOnAny" : false,
        "isComplete" : false,
        "mergeProcessor" : null,
        "handleByProcessor" : "SmsRequestConstructProcessor@4",
        "completeCoordinates" : {
          "x" : 100,
          "y" : 100
        },
        "completeCoordinatesSource" : null,
        "transitionsDoc" : [ {
          "mergeStatus" : "NO_AOC",
          "docs" : [ "AoC не найден.  У абонента нет активного аок." ]
        } ]
      }, {
        "mergeStatuses" : [ "SMS_PURCHASE_AOC" ],
        "isOnAny" : false,
        "isComplete" : false,
        "mergeProcessor" : null,
        "handleByProcessor" : "SmsRequestConstructProcessor@2",
        "completeCoordinates" : {
          "x" : 100,
          "y" : 100
        },
        "completeCoordinatesSource" : null,
        "transitionsDoc" : [ {
          "mergeStatus" : "SMS_PURCHASE_AOC",
          "docs" : [ "Корректный AoC. Продолжение SMS-покупки. Не реализовано" ]
        } ]
      } ]
    } ]
  }, {
    "mergePoints" : [ {
      "processor" : "SmsRequestConstructProcessor@4",
      "coordinates" : {
        "x" : 980,
        "y" : 1000
      },
      "coordinatesSource" : {
        "className" : "ru.fix.cpapsm.subscription.kafka.processing.config.SmppRoutingConfig",
        "fileName" : "SmppRoutingConfig.java",
        "fileNameLine" : 453
      },
      "mergeSource" : {
        "className" : "ru.fix.cpapsm.subscription.kafka.processing.config.SmppRoutingConfig",
        "fileName" : "SmppRoutingConfig.java",
        "fileNameLine" : 185
      },
      "transitions" : [ {
        "mergeStatuses" : [ ],
        "isOnAny" : true,
        "isComplete" : true,
        "mergeProcessor" : null,
        "handleByProcessor" : null,
        "completeCoordinates" : {
          "x" : 960,
          "y" : 1080
        },
        "completeCoordinatesSource" : {
          "className" : "ru.fix.cpapsm.subscription.kafka.processing.config.SmppRoutingConfig",
          "fileName" : "SmppRoutingConfig.java",
          "fileNameLine" : 470
        },
        "transitionsDoc" : [ ]
      } ]
    } ]
  }, {
    "mergePoints" : [ {
      "processor" : "SmsRequestConstructProcessor@2",
      "coordinates" : {
        "x" : 700,
        "y" : 1000
      },
      "coordinatesSource" : {
        "className" : "ru.fix.cpapsm.subscription.kafka.processing.config.SmppRoutingConfig",
        "fileName" : "SmppRoutingConfig.java",
        "fileNameLine" : 454
      },
      "mergeSource" : {
        "className" : "ru.fix.cpapsm.subscription.kafka.processing.config.SmppRoutingConfig",
        "fileName" : "SmppRoutingConfig.java",
        "fileNameLine" : 185
      },
      "transitions" : [ {
        "mergeStatuses" : [ ],
        "isOnAny" : true,
        "isComplete" : true,
        "mergeProcessor" : null,
        "handleByProcessor" : null,
        "completeCoordinates" : {
          "x" : 680,
          "y" : 1090
        },
        "completeCoordinatesSource" : {
          "className" : "ru.fix.cpapsm.subscription.kafka.processing.config.SmppRoutingConfig",
          "fileName" : "SmppRoutingConfig.java",
          "fileNameLine" : 471
        },
        "transitionsDoc" : [ ]
      } ]
    } ]
  }, {
    "mergePoints" : [ {
      "processor" : "MessageBodyAnalyzeProcessor@1",
      "coordinates" : {
        "x" : 1350,
        "y" : 840
      },
      "coordinatesSource" : {
        "className" : "ru.fix.cpapsm.subscription.kafka.processing.config.SmppRoutingConfig",
        "fileName" : "SmppRoutingConfig.java",
        "fileNameLine" : 455
      },
      "mergeSource" : {
        "className" : "ru.fix.cpapsm.subscription.kafka.processing.config.SmppRoutingConfig",
        "fileName" : "SmppRoutingConfig.java",
        "fileNameLine" : 123
      },
      "transitions" : [ {
        "mergeStatuses" : [ "UNSUBSCRIBE_MESSAGE" ],
        "isOnAny" : false,
        "isComplete" : false,
        "mergeProcessor" : null,
        "handleByProcessor" : "ServiceFetchProcessor@3",
        "completeCoordinates" : {
          "x" : 100,
          "y" : 100
        },
        "completeCoordinatesSource" : null,
        "transitionsDoc" : [ {
          "mergeStatus" : "UNSUBSCRIBE_MESSAGE",
          "docs" : [ "Текст сообщения содержит префикс отписки" ]
        } ]
      }, {
        "mergeStatuses" : [ "OTHER_MESSAGE" ],
        "isOnAny" : false,
        "isComplete" : false,
        "mergeProcessor" : null,
        "handleByProcessor" : "ServiceFetchProcessor@1",
        "completeCoordinates" : {
          "x" : 100,
          "y" : 100
        },
        "completeCoordinatesSource" : null,
        "transitionsDoc" : [ {
          "mergeStatus" : "OTHER_MESSAGE",
          "docs" : [ "Иной текст сообщения" ]
        } ]
      } ]
    } ]
  }, {
    "mergePoints" : [ {
      "processor" : "ServiceFetchProcessor@1",
      "coordinates" : {
        "x" : 1410,
        "y" : 1090
      },
      "coordinatesSource" : {
        "className" : "ru.fix.cpapsm.subscription.kafka.processing.config.SmppRoutingConfig",
        "fileName" : "SmppRoutingConfig.java",
        "fileNameLine" : 456
      },
      "mergeSource" : {
        "className" : "ru.fix.cpapsm.subscription.kafka.processing.config.SmppRoutingConfig",
        "fileName" : "SmppRoutingConfig.java",
        "fileNameLine" : 510
      },
      "transitions" : [ {
        "mergeStatuses" : [ "SINGLE_SERVICE" ],
        "isOnAny" : false,
        "isComplete" : false,
        "mergeProcessor" : null,
        "handleByProcessor" : "SmsRequestConstructProcessor@5",
        "completeCoordinates" : {
          "x" : 100,
          "y" : 100
        },
        "completeCoordinatesSource" : null,
        "transitionsDoc" : [ {
          "mergeStatus" : "SINGLE_SERVICE",
          "docs" : [ "Найден один сервис" ]
        } ]
      }, {
        "mergeStatuses" : [ "SERVICE_NOT_FOUND" ],
        "isOnAny" : false,
        "isComplete" : true,
        "mergeProcessor" : null,
        "handleByProcessor" : null,
        "completeCoordinates" : {
          "x" : 1390,
          "y" : 1260
        },
        "completeCoordinatesSource" : {
          "className" : "ru.fix.cpapsm.subscription.kafka.processing.config.SmppRoutingConfig",
          "fileName" : "SmppRoutingConfig.java",
          "fileNameLine" : 472
        },
        "transitionsDoc" : [ {
          "mergeStatus" : "SERVICE_NOT_FOUND",
          "docs" : [ "Сервис не найден" ]
        } ]
      } ]
    } ]
  }, {
    "mergePoints" : [ {
      "processor" : "ServiceFetchProcessor@3",
      "coordinates" : {
        "x" : 1840,
        "y" : 1060
      },
      "coordinatesSource" : {
        "className" : "ru.fix.cpapsm.subscription.kafka.processing.config.SmppRoutingConfig",
        "fileName" : "SmppRoutingConfig.java",
        "fileNameLine" : 457
      },
      "mergeSource" : {
        "className" : "ru.fix.cpapsm.subscription.kafka.processing.config.SmppRoutingConfig",
        "fileName" : "SmppRoutingConfig.java",
        "fileNameLine" : 510
      },
      "transitions" : [ {
        "mergeStatuses" : [ "SINGLE_SERVICE" ],
        "isOnAny" : false,
        "isComplete" : false,
        "mergeProcessor" : null,
        "handleByProcessor" : "SmsRequestConstructProcessor@3",
        "completeCoordinates" : {
          "x" : 100,
          "y" : 100
        },
        "completeCoordinatesSource" : null,
        "transitionsDoc" : [ {
          "mergeStatus" : "SINGLE_SERVICE",
          "docs" : [ "Найден один сервис" ]
        } ]
      }, {
        "mergeStatuses" : [ "SERVICE_NOT_FOUND" ],
        "isOnAny" : false,
        "isComplete" : true,
        "mergeProcessor" : null,
        "handleByProcessor" : null,
        "completeCoordinates" : {
          "x" : 2000,
          "y" : 1110
        },
        "completeCoordinatesSource" : {
          "className" : "ru.fix.cpapsm.subscription.kafka.processing.config.SmppRoutingConfig",
          "fileName" : "SmppRoutingConfig.java",
          "fileNameLine" : 473
        },
        "transitionsDoc" : [ {
          "mergeStatus" : "SERVICE_NOT_FOUND",
          "docs" : [ "Сервис не найден" ]
        } ]
      } ]
    } ]
  }, {
    "mergePoints" : [ {
      "processor" : "SmsRequestConstructProcessor@5",
      "coordinates" : {
        "x" : 1150,
        "y" : 1280
      },
      "coordinatesSource" : {
        "className" : "ru.fix.cpapsm.subscription.kafka.processing.config.SmppRoutingConfig",
        "fileName" : "SmppRoutingConfig.java",
        "fileNameLine" : 458
      },
      "mergeSource" : {
        "className" : "ru.fix.cpapsm.subscription.kafka.processing.config.SmppRoutingConfig",
        "fileName" : "SmppRoutingConfig.java",
        "fileNameLine" : 185
      },
      "transitions" : [ {
        "mergeStatuses" : [ ],
        "isOnAny" : true,
        "isComplete" : true,
        "mergeProcessor" : null,
        "handleByProcessor" : null,
        "completeCoordinates" : {
          "x" : 1120,
          "y" : 1370
        },
        "completeCoordinatesSource" : {
          "className" : "ru.fix.cpapsm.subscription.kafka.processing.config.SmppRoutingConfig",
          "fileName" : "SmppRoutingConfig.java",
          "fileNameLine" : 474
        },
        "transitionsDoc" : [ ]
      } ]
    } ]
  }, {
    "mergePoints" : [ {
      "processor" : "SmsRequestConstructProcessor@3",
      "coordinates" : {
        "x" : 1720,
        "y" : 1270
      },
      "coordinatesSource" : {
        "className" : "ru.fix.cpapsm.subscription.kafka.processing.config.SmppRoutingConfig",
        "fileName" : "SmppRoutingConfig.java",
        "fileNameLine" : 459
      },
      "mergeSource" : {
        "className" : "ru.fix.cpapsm.subscription.kafka.processing.config.SmppRoutingConfig",
        "fileName" : "SmppRoutingConfig.java",
        "fileNameLine" : 185
      },
      "transitions" : [ {
        "mergeStatuses" : [ ],
        "isOnAny" : true,
        "isComplete" : true,
        "mergeProcessor" : null,
        "handleByProcessor" : null,
        "completeCoordinates" : {
          "x" : 1680,
          "y" : 1370
        },
        "completeCoordinatesSource" : {
          "className" : "ru.fix.cpapsm.subscription.kafka.processing.config.SmppRoutingConfig",
          "fileName" : "SmppRoutingConfig.java",
          "fileNameLine" : 475
        },
        "transitionsDoc" : [ ]
      } ]
    } ]
  } ],
  "serializationPointSource" : null
} ]</script>
    <script>$(function () {

    let ZOOM = 1;

    _data.forEach((payload) => {
        payload.mergePoints = payload.mergeGroups.reduce((mergePoints, mergeGroup) => {
            return mergePoints.concat(mergeGroup.mergePoints);
        }, []);
    });

    // перести название процессора в массив переходов
    _data.forEach((payload) => {
        payload.mergePoints.forEach((mergePoint) => {
            mergePoint.transitions.forEach((transition) => {
                transition.processor = mergePoint.processor;
            });
        });
    });

    // клонировать переход для каждого handleByProcessor или mergeProcessor
    // для того чтобы из transition.mergeProcessors => [ transition.mergeProcessor, transition.mergeProcessor ]
    _data.forEach((payload) => {
        payload.mergePoints.forEach((mergePoint) => {
            mergePoint.transitions.forEach((transition) => {
                if (transition.handleByProcessors && transition.mergeProcessors) {
                    return alert('Error: transition.handleByProcessors && transition.mergeProcessors');
                }
                if (transition.handleByProcessors) {
                    if (transition.handleByProcessors.length > 1) {
                        transition.handleByProcessors.forEach((handleByProcessor, i) => {
                            if (i === 0) {
                                transition.handleByProcessor = handleByProcessor;
                            } else {
                                let newTransition = $.extend(true, {}, transition);
                                newTransition.handleByProcessor = handleByProcessor;
                                delete newTransition.handleByProcessors;
                                mergePoint.transitions.push(newTransition);
                            }
                        });
                    } else {
                        transition.handleByProcessor = transition.handleByProcessors[0];
                    }
                    delete transition.handleByProcessors;
                }
                if (transition.mergeProcessors) {
                    if (transition.mergeProcessors.length > 1) {
                        transition.mergeProcessors.forEach((mergeProcessor, i) => {
                            if (i === 0) {
                                transition.mergeProcessor = mergeProcessor;
                            } else {
                                let newTransition = $.extend(true, {}, transition);
                                newTransition.mergeProcessor = mergeProcessor;
                                delete newTransition.mergeProcessor;
                                mergePoint.transitions.push(newTransition);
                            }
                        });
                    } else {
                        transition.mergeProcessor = transition.mergeProcessors[0];
                    }
                    delete transition.mergeProcessors;
                }
            });
        });
    });


    _data.forEach((payload, i) => {

        let dataSource = Object.keys(payload.processors).map((processor) => {
            return {
                id: processor,
                name: processor,
                handlerName: payload.processors[processor].handlerName || '',
                _type: 'PROCESSOR',
                x: payload.processors[processor].coordinates.x * ZOOM,
                y: payload.processors[processor].coordinates.y * ZOOM,
            };
        }).concat(
            payload.mergePoints.map((mergePoint) => {
                return {
                    id: `FROM.${ mergePoint.processor }`,
                    name: '',
                    width: 50,
                    height: 50,
                    type: 'circle',
                    _type: 'MERGE',
                    x: mergePoint.coordinates.x * ZOOM,
                    y: mergePoint.coordinates.y * ZOOM,
                };
            })
        ).concat([
            {
                id: 'START',
                name: payload.payload.payloadName,
                _type: 'EDGE',
                x: payload.startPoint.coordinates.x * ZOOM,
                y: payload.startPoint.coordinates.y * ZOOM,
            }
        ]).concat(
            payload.mergePoints.reduce((transitionsToEnd, mergePoint) => {
                return transitionsToEnd.concat(
                    mergePoint.transitions.filter((transition) => {
                        return transition.isComplete;
                    }).map((transitionToEnd) => {
                        transitionToEnd.from = `FROM.${ mergePoint.processor }`;
                        return transitionToEnd;
                    })
                );
            }, []).map((transitionToEnd) => {
                return {
                    id: `END.${ transitionToEnd.from }`,
                    name: 'END',
                    _type: 'EDGE',
                    x: transitionToEnd.completeCoordinates.x * ZOOM,
                    y: transitionToEnd.completeCoordinates.y * ZOOM
                };
            })
        ).map((edge) => {
            edge.width = 100;
            edge.height = 40;
            edge.type = 'circle';
            return edge;
        });

        let connectionsDataSource = payload.startPoint.processors.map((processor) => {
            return {from: 'START', to: processor, label: ''};
        }).concat(
            payload.mergePoints.map((mergePoint) => {
                return {from: mergePoint.processor, to: `FROM.${ mergePoint.processor }`, label: ''}
            })
        ).concat(
            payload.mergePoints.reduce((transitions, mergePoint) => {
                return transitions.concat(mergePoint.transitions);
            }, []).map((transition) => {

                var transitionLabel = '';
                if (transition.isOnAny) {
                    transitionLabel = '&lt;Any&gt;';
                } else {
                    if(transition.mergeStatuses && transition.mergeStatuses.length > 0){
                        for (var i = 0; i < transition.mergeStatuses.length; i++) {
                            transitionLabel += ',' + transition.mergeStatuses[i];
                        }
                        transitionLabel = transitionLabel.substring(1);
                    }
                }

                if (transition.isComplete) {
                    return {
                        from: `FROM.${ transition.processor }`,
                        to: `END.FROM.${ transition.processor }`,
                        label: transitionLabel,
                        docs : transition.transitionsDoc
                    }
                } else {
                    if (transition.handleByProcessor) {
                        return {
                            from: `FROM.${ transition.processor }`,
                            to: transition.handleByProcessor,
                            label: transitionLabel,
                            docs : transition.transitionsDoc,
                            isCopyHandler: payload.processors[transition.handleByProcessor].isCopyHandler
                        }
                    }
                    if (transition.mergeProcessor) {
                        return {
                            from: `FROM.${ transition.processor }`,
                            to: `FROM.${ transition.mergeProcessor }`,
                            label: transitionLabel,
                            docs : transition.transitionsDoc
                        }
                    }
                }
            })
        );

        let isActiveClass = i === 0 ? 'active' : '';

        $('.nav.nav-tabs').append('<li role="presentation" class="' + isActiveClass + '"><a href="#tab' + i + '" aria-controls="home" role="tab" data-toggle="tab">' + payload.payload.payloadName + '</a></li>');
        $('.tab-content').append('<div role="tabpanel" class="tab-pane ' + isActiveClass + '" id="tab' + i + '"><div class="diagram" id="diagram' + i + '"></div><div class="docs"></div></div>');

        $("#diagram" + i).kendoDiagram({
            dataSource,
            connectionsDataSource,
            shapeDefaults: {
                content: { template: "#= name #" },
                fill: '#ddd',
                hover: { fill: "#ccc"  },
                visual: (options) => {
                    var group = new kendo.dataviz.diagram.Group({ autoSize: true });
                    if (options.dataItem) {
                        switch (options.dataItem._type) {
                            case 'PROCESSOR':
                                var shape = new kendo.dataviz.diagram.Rectangle({
                                    width: 200,
                                    height: 70,
                                    fill: '#ddd',
                                    hover: { fill: "#ccc" }
                                });
                                break;
                            case 'MERGE':
                            case 'EDGE':
                                var shape = new kendo.dataviz.diagram.Circle({
                                    width: 50,
                                    height: 50,
                                    fill: '#ddd',
                                    hover: { fill: "#ccc" }
                                });
                                break;
                        }
                        group.append(shape);
                        if (options.dataItem._type === 'PROCESSOR' && options.dataItem.handlerName) {
                            var layout = new kendo.dataviz.diagram.Layout(new kendo.dataviz.diagram.Rect(0, 20, 200, 70), {
                                alignContent: "center",
                                alignItems: "center",
                                justifyContent: "center",
                                orientation: "vertical"
                            });
                            group.append(layout);
                            var text = new kendo.dataviz.diagram.TextBlock({
                                text: '.' + options.dataItem.handlerName + '()'
                            });
                            layout.append(text);
                            layout.reflow();
                        }
                    } else {
                        if (options._type === 'MERGE_GROUP') {
                            let { height, width } = options;
                            let config = $.extend({}, { height, width }, {
                                // fill: '#ddd',
                                // hover: { fill: "#ccc" }
                            });
                            let shape = new kendo.dataviz.diagram.Rectangle(config);
                            group.append(shape);
                        }
                    }
                    return group;
                }
            },
            connectionDefaults: {
                stroke: {
                    color: "#979797",
                    width: 3
                },
                type: "polyline",
                startCap: "FilledCircle",
                endCap: "ArrowEnd",
                content: {
                    template: "#= label#"
                }
            },
            autoBind: true,

            click: (clickEvent) => {
                if (clickEvent.item instanceof kendo.dataviz.diagram.Connection) {

                    if(clickEvent.item.lastClickTimestamp) {
                        if(Date.now() - clickEvent.item.lastClickTimestamp < 300){
                            var target = clickEvent.item.to;
                            if(target) {
                                target.position(clickEvent.point);
                            }
                        }
                    }
                    clickEvent.item.lastClickTimestamp = Date.now();
                    return clickEvent.preventDefault();
                }
            },

            mouseEnter: (e) => {
                if (!e.item.dataItem) { return; }
                if (e.item instanceof kendo.dataviz.diagram.Connection) {
                    if(e.item.dataItem) {
                        if(e.item.dataItem.docs){
                            var docs = e.item.dataItem.docs;

                            var transitionDescriptionHtml = '';

                            docs.forEach((doc) => {
                                transitionDescriptionHtml += '' + doc.mergeStatus + '<br />';

                                if(doc.docs) {
                                    doc.docs.forEach((line) => {
                                        transitionDescriptionHtml += '' + line + '<br />';
                                    });
                                }

                                transitionDescriptionHtml += '<br />';
                        });

                        }
                    }

                    $('#tab' + i + ' .docs').html(transitionDescriptionHtml);
                    return e.preventDefault();
                }

                let html = '[' + e.item.dataItem.x + '.' + e.item.dataItem.y + ']<br />';

                if (e.item.dataItem._type === "PROCESSOR") {

                    var processorInfo = payload.processors[e.item.dataItem.name];

                    html += processorInfo.handlerName;
                    html += '<br />';
                    html += '* * * * *';
                    html += '<br />';
                    html += processorInfo.processorDoc ? processorInfo.processorDoc.join('<br />') : '<br />';
                    html += '<br />';
                    html += '* * * * *';
                    html += '<br />';
                    html += processorInfo.requestDoc ? processorInfo.requestDoc.join('<br />') : '';
                }

                if (e.item.dataItem.id === "START") {

                    html += payload.payload.payloadDoc ? payload.payload.payloadDoc.join('<br />') : '<br />';
                    html += '<br />';

                    html += '* * * * *';
                    html += '<br />';

                    html += $("#diagram" + i).getKendoDiagram().dataSource.view().reduce((graphPoints, shape) => {

                        switch (shape._type) {
                            case 'PROCESSOR':
                                graphPoints += `.proc("${ shape.id }", ${ shape.x }, ${ shape.y })<br />`;
                                break;
                            case 'MERGE':
                                graphPoints += `.merge("${ shape.id.substr(5) }", ${ shape.x }, ${ shape.y })<br />`;
                                break;
                            case 'EDGE':
                                graphPoints += shape.id === 'START'
                                    ? `.start(${ shape.x }, ${ shape.y })<br />`
                                    : `.complete("${ shape.id.substr(9) }", ${ shape.x }, ${ shape.y })<br />`;
                                break;
                        }

                        return graphPoints;

                    }, '');

                }

                $('#tab' + i + ' .docs').html(html);
            }
            // editable: false,
        }).data('kendoDiagram').zoom(ZOOM);

        $("#diagram" + i).getKendoDiagram().connections.map((connection) => {
            if (connection.dataItem.isCopyHandler) {
                connection.redraw({ stroke: { color: 'brown' } });
            }
        });

        payload.mergeGroups.filter((mergeGroup) => {
            return mergeGroup.mergePoints.length > 1;
        }).map((mergeGroup) => {
            // // let shape = new kendo.dataviz.diagram.Point(100,220);
            // shape._type = 'MERGE_GROUP';
            let coordinates = mergeGroup.mergePoints.map((mergePoint) => { return [mergePoint.coordinates.x, mergePoint.coordinates.y]; });
            let xList = coordinates.map((cordinate) => { return cordinate[0]; });
            let yList = coordinates.map((cordinate) => { return cordinate[1]; });
            let xMin = Math.min.apply(this, xList);
            let xMax = Math.max.apply(this, xList);
            let yMin = Math.min.apply(this, yList);
            let yMax = Math.max.apply(this, yList);
            let padding = 10;
            let mergePointLength = 50;
            let shapeConfig = {
                _type: 'MERGE_GROUP',
                x: xMin * ZOOM - padding,
                y: yMin * ZOOM - padding,
                width: (xMax - xMin) * ZOOM + mergePointLength + padding * 2,
                height: (yMax - yMin) * ZOOM + mergePointLength + padding * 2
            };
            // debugger;
            $("#diagram" + i).getKendoDiagram().addShape(shapeConfig);
        });

    });

    $('a[data-toggle="tab"]').on('shown.bs.tab', function (e) {
        kendo.resize($("body"));
    });


});</script>
</head>
	<ul class="nav nav-tabs" role="tablist"></ul>
	<div class="tab-content"></div>
</body>
</html>